Ten_Desires_fallen_empire_init = {
    set_spawn_system_batch = begin
    no_scope = {
        Ten_Desires_fallen_empire_species_init = yes
        create_country = {
            name = "leader_trait_Ten_Desires"
            type = Ten_Desires_fallen_empire
            ignore_initial_colony_error = yes
            authority = auth_imperial
            flag = random
            civics = {
                civic = civic_Ten_Desires
                civic = random
            }
            origin = origin_Ten_fallen_empires#origin_slavers
            ethos = {
                ethic = ethic_spiritualist
                ethic = ethic_militarist
                ethic = ethic_xenophile
            }
            species = last_created_species
            effect = {
                save_global_event_target_as = Ten_Desires_fallen_empire
                add_modifier = { modifier =Ten_Desires_fallen_empire_mod   }
                set_country_flag = Ten_Desires_fallen_empire
                add_resource = {
                    minerals = 90000
                    energy = 90000
                    food = 9000
                    influence = 900
                }
                if = {
                    limit = { host_has_dlc = "Apocalypse" }
                    give_technology = {
                        tech = tech_colossus
                        message = no
                    }
                }
                Miyako_Yoshika_created = yes
                NyanNyan_created = yes
                tho_fleet_builder = {
                    fleet_num = 3
                    ship_design = th13_Ten_fallen_empires_big_ship
                    owner = last_created_country
                    ship_num = 2
                    leader = last_created_leader
                }
                tho_fleet_builder = {
                    fleet_num = 2
                    owner = last_created_country
                    ship_class = constructor
                }
                Toyosatomimi_no_Miko_created = yes
                assign_leader = last_created_leader
                created_Futo = yes
                Soga_Tojiko_created = yes
                ruler = {
                    add_skill = 10
                }
            }
        }
        spawn_system = {
            initializer = Ten_Desires_System_init_fallen_empire
            min_distance >= 400
            max_distance <= 400
            min_orientation_angle >= 90
            max_orientation_angle <= 90
            hyperlane = no
        }

    }
    set_spawn_system_batch = end
}
Ten_Desires_fallen_empire_species_init = {
    random_list = {
        10 = {
            create_species = {
                name = random
                class = MACHINE
                namelist = MACHINE3
                portrait = random
                traits = {
                    #trait = trait_Ten_Desires
                    trait = random_traits
                    trait = random_presapient_trait
                }
                extra_trait_points = 5
                allow_negative_traits = no
                effect = {
                    save_global_event_target_as = Ten_Desires_fallen_empire_species
                }
            }

        }
        10 = {
            create_species = {
                name = random
                class =HUM
                namelist =HUMAN3
                portrait = random
                traits = {
                    #trait = trait_Ten_Desires
                    trait = random_traits
                    trait = random_presapient_trait
                }
                extra_trait_points = 5
                allow_negative_traits = no
                effect = {
                    save_global_event_target_as = Ten_Desires_fallen_empire_species
                }
            }
        }
        10 = {
            modifier = {
                is_archetype = TOUHOUGIRLS
                mult = 10
            }
            modifier = { NOT = { is_archetype = TOUHOUGIRLS }mult = 0 }
            create_species = {
                name = random
                class =THSC
                namelist =HUMAN3
                portrait = random
                traits = {
                    #trait = trait_Ten_Desires
                    trait = trait_touhou
                    trait = trait_Ten_Desire_fallen_empire8
                    trait =trait_xiaoemo
                    trait =trait_Ten_Desire_fallen_empire11
                    trait = trait_xiaoren
                }
                extra_trait_points = 5
                allow_negative_traits = no
                effect = {
                    save_global_event_target_as = Ten_Desires_fallen_empire_species
                }
            }
        }
    }
}
Ten_Desire_fallen_empire_capital = {
        #区划
        random_list = {
            1 = {
                while = {
                    count = 4
                    add_district = district_Ten_Desires_page2
                    add_district = district_Ten_Desires_ex
                }
            }
            1 = {
                while = {
                    count = 4
                    add_district = district_Ten_Desires
                    add_district = district_Ten_Desires_alloys
                }
            }
            1 = {
                add_district = district_Ten_Desires
                add_district = district_Ten_Desires_alloys
                add_district = district_Ten_Desires_page2
                add_district = district_Ten_Desires_ex
            }
            1 = {
                while = {
                    count = 5
                    add_district = district_Ten_Desires_page2
                }
            }
            1 = {
                while = {
                    count = 5
                    add_district = district_Ten_Desires_alloys
                }

            }
            0 = {
                while = {
                    count = 4
                    remove_district = district_Ten_Desires_alloys
                }
            }
            1 = {
                while = {
                    count = 4
                    remove_district = district_Ten_Desires_alloys
                    remove_district = district_Ten_Desires
                }
            }
            1 = {
                while = {
                    count = 4
                    remove_district = district_Ten_Desires_page2
                }
            }
            10 = {

            }
        }
}
Ten_Desire_fallen_empire_planet = {
    optimize_memory
    every_owned_planet = {
        limit = {
            is_planet_class = pc_gaia
        }
        while = {
            count = 3
            add_building= building_sacred_nexus
        }
        while = {
            count = 2
            add_building= building_food_processing_facility
        }
        add_building= building_energy_nexus
        add_building= building_factory_3
        add_building= building_foundry_3
    }
    every_owned_planet = {
        limit = {
            OR = {
                is_planet_class = pc_shattered_ring_habitable
                is_planet_class = pc_ringworld_habitable
            }
        }
        while = {
            count = 5
            add_building= building_research_lab_3
        }
        add_building= building_foundry_3
    }
    every_owned_planet = {
        limit = {
            is_planet_class = pc_habitat
        }
        add_building= building_food_processing_facility
        add_building= building_mineral_purification_plant
        add_building= building_energy_nexus
    }
    every_owned_planet = {
        limit = {
            is_planet_class = pc_city
        }
        add_district = district_city
        add_building= building_hyper_entertainment_forum
    }
    random_owned_planet = {
        limit = {
            NOT = {
                tho_rary_planet_class = yes
            }
        }
        random_list = {
            2 = {
                add_building= building_factory_1
            }

            3 = {
                add_building= building_foundry_1
            }

            4 = {
                add_building= building_embassy
            }

            5 = {
                add_building= building_institute
            }

            6 = {
                add_building= building_ministry_production
            }

            7 = {
                add_building= building_galactic_stock_exchange
            }

            8 = {
                add_building= building_research_lab_1
            }
        }
        random_list = {
            2 = {
                add_district = district_industrial
                add_district = district_generator
                add_district = district_mining
            }
            3 = {
                add_district = district_generator
                add_district = district_mining
                add_district = district_farming
            }
            2 = {
                add_district = district_city
                add_district = district_generator
                add_district = district_mining
                add_district = district_farming
            }
            1 = {
                modifier = {
                    owner = {
                        OR = {
                            has_ethic = ethic_fanatic_militarist
                            has_ethic = ethic_militarist
                            has_authority = auth_imperial
                        }
                    }
                    add = 4
                }
                add_district = district_industrial
                add_district = district_hab_industrial
                add_district = district_arcology_civilian_industry
                add_district = district_arcology_arms_industry
            }
        }
    }
    random_owned_planet = {
        limit = {
            OR = {
                is_planet_class = pc_ringworld_habitable
                is_planet_class = pc_shattered_ring_habitable
            }
        }
        add_district = district_industrial
        add_district = district_hab_industrial
        add_district = district_rw_industrial
    }
}
Ten_Desire_fallen_empire_auto_move_ship = {
    random_system = {
        save_global_event_target_as = tho_scientist_targer
    }
    random_owned_fleet = {
        limit = {
            has_auto_move_target = yes
            NOT = { tho_is_ship_move_class = yes }
        }
        auto_move_to_planet = {
            target = event_target:tho_scientist_targer.star
            clear_auto_move_on_arrival = yes
        }
    }
}
Ten_Desire_fallen_empire_auto_move_ship_war = {
    random_country = {
        limit = {
            is_at_war_with = event_target:Ten_Desires_fallen_empire
        }
        random_owned_planet = {
            limit = {
                exists = owner
            }
            save_global_event_target_as = tho_scientist_targer
        }
    }
    random_owned_fleet = {
        limit = {
            has_auto_move_target = no
            NOT = { tho_is_ship_move_class = yes }
        }
        auto_move_to_planet = {
            target = event_target:tho_scientist_targer
            clear_auto_move_on_arrival = yes
        }
    }
}
Ten_Desire_fallen_empire_auto_move_ship_to_ship ={
    random_country = {
        limit = {
            is_at_war_with = event_target:Ten_Desires_fallen_empire
        }
        random_owned_fleet = {
            save_global_event_target_as = fleet_targer_fallen_war
        }
    }
    random_owned_fleet = {
        limit = {
            has_auto_move_target = no
            NOT = { tho_is_ship_class = yes }
        }
        auto_move_to_planet = {
            target = event_target:fleet_targer_fallen_war
            clear_auto_move_on_arrival = yes
        }
    }

}
